# 완벽한 디노

## Deno란

> 타입스크립트 기반의 런타입

- 디노는 2020년 5월 13일 공식 발표됨
- 2018년 Ryan Dahl이 "Node.js에 대해 후회하는 10가지" 발표를 통해 그 개념을 제시
- Rust와 Tokio(비동기 라이브러리)를 사용해 만들어졌으며, Go 언어의 설계 철학에서 상당 부분 영감을 받음

## Deno의 탄생 배경

> 디노는 노드의 기술적 부채를 보완하기 위해 고안됨

### 1. 노드의 보안적 취약성

- 노드는 안전하지 않은 코드를 실행할 수 있도록 설계됨
  - 노드는 TPC 네트워크 요청에 대한 보안 제어 기능이 부족
  - 기본적인 보안장치가 없어 모듈이 의도하지 않은 파일 시스템 접근까지 가능
- 실제 사사례로, 2018년 유명한 노드 모듈 저장소가 해킹당해 비트코인 지갑 정보를 탈취하는 사건이 발생

### 2. 모듈 시스템의 문제

- Ryan Dahl은 비동기 I/O, 이벤트 방출기 등 기능에 비해 노드 내부 설계는 체계적이지 못했다고 지적함
- npm의 중앙화된 비공개 저장소 관리 방식보다 브라우저가 URL을 통해 직접 모듈을 임포트하는 방식이 더 투명하고 유지보수에 유리하다고 판단

  ```html
  <!--예시-->

  <script
    type="text/javascript"
    src="http://yourhostname/resources/module.js"></script>
  ```

- package.json과 node_modules 폴더 시스템의 비효율성 문제:
  - package.json의 복잡한 문법과 관리의 어려움
  - node_modules 폴더의 비대화 문제

### 3. 기타 문제

- 확장자 생략 기능의 문제:

  - 노드는 확장자를 지정하지 않고 로컬 모듈을 요청할 수 있는 기능 제공
  - 실제로는 여러 확장자를 확인하는 로직이 필요해 오히려 복잡성 증가->성능 저하와 예측 불가능한 동작을 초래

- index.js 파일의 암묵적 동작:
  - 폴더 요청 시 기본적으로 index.js 파일을 요청하는 기능
  - 웹의 index.html 동작을 모방했으나 개발자 경험 개선에 실패
  - 의도하지 않은 패턴을 만들어내는 결과 초래

## Deno 시작하기

1. 디노 플레이그라운
   - 책에서 제공하는 링크는 https://deno-playground.now.sh, 404 오류 발생
   - https://www.mycompiler.io/ko/new/deno에서 디노 사용 가능
     ![alt text](<../../images/디노 플레이그라운드.png>)
2. 디노 설치(윈도우 기준)

   ```shell
   iwr https://deno.land/x/install/install.ps1 -useb | iex
   ```

   ![alt text](<../../images/디노 설치.png>)

3. 설치 확인
   ```shell
   $ deno
   ```
   ![alt text](<../../images/디노 설치 확인.png>)

## Deno의 멋진 기능들

디노는 노드의 근본적인 문제 해결과 ECMAScript 최신 버전과 타입스크립트 기능을 충분히 활용할 수 있도록 설계됨

### 1. 타입스크립트 지원

- 디노에서는 컴파일러가 타입스크립트 코드를 자바스크립트로 변환
- 빌드 과정에서 변환을 신경 쓸 필요 없음
- 인터프리터 내에서 컴파일 시간을 최적화 해 부트 시간이 단축됨

### 2. 보안성

- 노드에서는 안전하지 않은 코드 실행을 제어할 수 없음->취약 정보 훔치기가 가능
- 디노에서 노드와 동일한 동작을 수행하는 코드(훔치기 코드) 실행 시, 오류 발생
  - `Uncaught PermissionDenied: read access to "ex.ts",` - 파일 시스템 접근 권한 필요
  - `Uncaught PermissionDenied: access to environment variables,` - 환경 변수 접근 권한 필요
  - `PermissionDenied: network access to "http://localhost:8080/",` - 네트워크 접근 권한 필요
- 실행 시 --allow-read, --allow-write, --allow-net 등 명시적인 권한 플래그 필요
- 샌드박스 환경에서 안전하게 코드 실행 가능

### 3. 최상위 수준의 await

- await 절은 반드시 async 함수에서만 사용할 수 있었음
- 디노는 1.0버전부터 최상위 수준의 await를 바로 사용 가능
  - 시작 코드가 깔끔해짐
  - 의존성 폴백 구현이 쉬움
- 비동기 작업을 더 직관적이고 간단하게 처리 가능
- Promise 체인을 피하고 동기 코드처럼 작성 가능

### 4. 표준 라이브러리 확장 및 개선

- 디노는 제이쿼리 등 외부 라이브러리 없이 언어 내부 표준 라이브러리만으로 필요한 도구를 갖추고 고품질의 코드를 생성할 수 있음

### 5. 중앙화된 모듈 등록 방식 탈피

- 디노는 url로 코드를 임포트하는 기능을 제공
- 모듈 설치를 신경 쓸 필요가 없음
- 캐시 기능으로 한번 다운로드한 모듈은 재사용
- 중앙 저장소 의존성 제거로 보안성 향상
